"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2190],{2190:(e,r,t)=>{t.d(r,{FirebaseDatabase:()=>o});class o{constructor(e){this.db=null,this.app=null,this.config=e}async connect(){try{try{let{initializeApp:e}=await Promise.resolve().then(function(){var e=Error("Cannot find module 'firebase/app'");throw e.code="MODULE_NOT_FOUND",e}),{getFirestore:r,connectFirestoreEmulator:t}=await Promise.resolve().then(function(){var e=Error("Cannot find module 'firebase/firestore'");throw e.code="MODULE_NOT_FOUND",e});return this.app=e(this.config),this.db=r(this.app),!0}catch(e){return console.warn("Firebase packages not installed. Install with: npm install firebase"),!1}}catch(e){return console.error("Firebase connection failed:",e),!1}}async disconnect(){try{if(this.app){let{deleteApp:e}=await Promise.resolve().then(function(){var e=Error("Cannot find module 'firebase/app'");throw e.code="MODULE_NOT_FOUND",e});await e(this.app)}}catch(e){console.error("Firebase disconnect failed:",e)}}async testConnection(){try{if(!this.db)return!1;let{doc:e,getDoc:r}=await Promise.resolve().then(function(){var e=Error("Cannot find module 'firebase/firestore'");throw e.code="MODULE_NOT_FOUND",e}),t=e(this.db,"test","connection");return await r(t),!0}catch(e){return console.error("Firebase connection test failed:",e),!1}}async create(e,r){try{let{collection:t,addDoc:o,serverTimestamp:a}=await Promise.resolve().then(function(){var e=Error("Cannot find module 'firebase/firestore'");throw e.code="MODULE_NOT_FOUND",e}),i={...r,createdAt:r.createdAt||a(),updatedAt:a()};return{id:(await o(t(this.db,e),i)).id,...i}}catch(e){throw console.error("Firebase create failed:",e),e}}async read(e,r){try{if(r){let{doc:t,getDoc:o}=await Promise.resolve().then(function(){var e=Error("Cannot find module 'firebase/firestore'");throw e.code="MODULE_NOT_FOUND",e}),a=t(this.db,e,r),i=await o(a);if(i.exists())return{id:i.id,...i.data()};return null}{let{collection:r,getDocs:t}=await Promise.resolve().then(function(){var e=Error("Cannot find module 'firebase/firestore'");throw e.code="MODULE_NOT_FOUND",e}),o=await t(r(this.db,e)),a={};return a[e]=[],o.forEach(r=>{a[e].push({id:r.id,...r.data()})}),a}}catch(e){throw console.error("Firebase read failed:",e),e}}async update(e,r,t){try{let{doc:o,updateDoc:a,getDoc:i,serverTimestamp:n}=await Promise.resolve().then(function(){var e=Error("Cannot find module 'firebase/firestore'");throw e.code="MODULE_NOT_FOUND",e}),s=o(this.db,e,r),c={...t,updatedAt:n()};await a(s,c);let l=await i(s);return{id:l.id,...l.data()}}catch(e){throw console.error("Firebase update failed:",e),e}}async delete(e,r){try{let{doc:t,deleteDoc:o}=await Promise.resolve().then(function(){var e=Error("Cannot find module 'firebase/firestore'");throw e.code="MODULE_NOT_FOUND",e}),a=t(this.db,e,r);return await o(a),!0}catch(e){return console.error("Firebase delete failed:",e),!1}}async query(e,r){try{let{collection:t,query:o,where:a,orderBy:i,limit:n,getDocs:s}=await Promise.resolve().then(function(){var e=Error("Cannot find module 'firebase/firestore'");throw e.code="MODULE_NOT_FOUND",e}),c=t(this.db,e);if(r){let e=[];Object.keys(r).forEach(t=>{let o=r[t];null!=o&&("_orderBy"===t?e.push(i(o.field,o.direction||"asc")):"_limit"===t?e.push(n(o)):e.push(a(t,"==",o)))}),e.length>0&&(c=o(c,...e))}let l=await s(c),d=[];return l.forEach(e=>{d.push({id:e.id,...e.data()})}),d}catch(e){throw console.error("Firebase query failed:",e),e}}async count(e,r){try{let{collection:t,query:o,where:a,getCountFromServer:i}=await Promise.resolve().then(function(){var e=Error("Cannot find module 'firebase/firestore'");throw e.code="MODULE_NOT_FOUND",e}),n=t(this.db,e);if(r){let e=[];Object.keys(r).forEach(t=>{let o=r[t];null!=o&&"_orderBy"!==t&&"_limit"!==t&&e.push(a(t,"==",o))}),e.length>0&&(n=o(n,...e))}return(await i(n)).data().count}catch(e){return console.error("Firebase count failed:",e),0}}async backup(){try{let e={};for(let r of["services","bookings","customers","users","messages","notifications"])e[r]=await this.read(r);return e}catch(e){throw console.error("Firebase backup failed:",e),e}}async restore(e){try{let{writeBatch:r}=await Promise.resolve().then(function(){var e=Error("Cannot find module 'firebase/firestore'");throw e.code="MODULE_NOT_FOUND",e}),t=r(this.db);for(let[r,o]of Object.entries(e))if(Array.isArray(o))for(let e of o){let{doc:o}=await Promise.resolve().then(function(){var e=Error("Cannot find module 'firebase/firestore'");throw e.code="MODULE_NOT_FOUND",e}),a=o(this.db,r,e.id||"");t.set(a,e)}return await t.commit(),!0}catch(e){return console.error("Firebase restore failed:",e),!1}}}}}]);